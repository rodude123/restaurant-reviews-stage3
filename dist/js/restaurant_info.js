let restaurant;var map;let c1=0,c2=0,c3=0,c4=0;window.initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),0==c1&&(fillBreadcrumb(),c1=1),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,a)=>{self.restaurant=a,a?(0==c2&&(fillRestaurantHTML(),c2=1),e(null,a)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("aLazy");t.className="progressive replace",t.href=DBHelper.imageUrlForRestaurant(e)+"800.webp",t.setAttribute("data-srcset",`${DBHelper.imageUrlForRestaurant(e)}300.webp 400w, ${DBHelper.imageUrlForRestaurant(e)}400.webp 600w, ${DBHelper.imageUrlForRestaurant(e)}600.webp 800w, ${DBHelper.imageUrlForRestaurant(e)}800.webp 1200w`);const a=document.getElementById("restaurant-img");a.className="restaurant-img preview","Mission Chinese Food"==e.name?(a.alt="People sitting inside Mission Chinese Food",a.arialabel="People sitting inside Mission Chinese Food"):"Kang Ho Dong Baekjeong"==e.name?(a.alt="Empty restaurant with orange looking tables and chairs angled more towards the left",a.arialabel="Empty restaurant with orange looking tables and chairs angled more towards the left"):"Katz's Delicatessen"==e.name?(a.alt="Outside night photo of the restaurant",a.arialabel="Outside night photo of the restaurant"):"Roberta's Pizza"==e.name?(a.alt="People sitting inside Roberta's Pizza",a.arialabel="People sitting inside Roberta's Pizza"):"Hometown BBQ"==e.name?(a.alt="American themed restaurant with people sitting inside",a.arialabel="American themed restaurant with people sitting inside"):"Superiority Burger"==e.name?(a.alt="Black and white photo of the outside of the Superiority Burger restaurant and with people inside",a.arialabel="Black and white photo of the outside of the Superiority Burger restaurant and with people inside"):"The Dutch"==e.name?(a.alt="Close up view of the outside of the restaurant",a.arialabel="Close up view of the outside of the restaurant"):"Mu Ramen"==e.name?(a.alt="Slightly blured black and white photo of people sitting and eating",a.arialabel="Slightly blured black and white photo of people sitting and eating"):"Casa Enrique"==e.name&&(t.href="/imgRes/10-400.webp",t.setAttribute("data-srcset","/imgRes/10-300.webp 400w, /imgRes/10-400.webp 600w, /imgRes/10-600.webp 800w, /imgRes/10-800.webp 1200w"),a.alt="Empty restaurant with tables and chairs angled towards the left",a.arialabel="Empty restaurant with tables and chairs angled towards the left");const n=document.createElement("a");n.innerHTML="&#9733;",n.id="addToFav","true"==e.is_favorite?n.className="tooltip isFav":n.className="tooltip isNotFav",n.setAttribute("aria-label","Add to favourite"),n.style.marginLeft="100px";const r=document.createElement("span");r.className="tooltiptext",r.innerHTML="Add to favourites",n.setAttribute("role","switch"),n.append(r),n.addEventListener("click",function(){DBHelper.addRemFav(e.id,n,e,r)}),document.getElementById("favContainer").append(n),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&0==c3&&(fillRestaurantHoursHTML(),c3=1),0==c4&&(fillReviewsHTML(e),document.getElementById("reviewForm").addEventListener("submit",t=>{t.preventDefault(),checkReview(getParameterByName("id"),e.reviews)}),c4=1)}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let a in e){const n=document.createElement("tr"),r=document.createElement("td");r.innerHTML=a,n.appendChild(r);const i=document.createElement("td");i.innerHTML=e[a],n.appendChild(i),t.appendChild(n)}}),fillReviewsHTML=(e=>{const t=document.getElementById("reviews-container"),a=document.createElement("h3");a.innerHTML="Reviews",t.appendChild(a),DBHelper.fetchReviewsById(parseInt(getParameterByName("id"))).then(a=>{if(0==a.length){const e=document.createElement("p");e.innerHTML="No reviews yet. Be the first one!",t.appendChild(e)}else e.reviews=a,ul=document.getElementById("reviews-list"),a.forEach(e=>{ul.appendChild(createReviewHTML(e,e.updatedAt))}),t.appendChild(ul)})}),checkReview=((e,t)=>{const a=strip(document.getElementById("name").value),n=strip(document.getElementById("reviewBody").value),r=parseInt(document.querySelector('input[name="rating"]:checked').value);if(navigator.onLine)DBHelper.postReview(parseInt(e),a,r,n,t).then(e=>{document.getElementById("reviewModal").style.display="none",document.getElementById("reviews-list").appendChild(createReviewHTML(e,e.updatedAt)),showMessage("Review added")});else{showMessage("It seems your ofline right now, the review will be sent when your online later"),document.getElementById("reviewModal").style.display="none",DBHelper.storeOflineReview(parseInt(e),a,n,r);let i=setInterval(()=>{navigator.onLine&&(clearInterval(i),showMessage("Attempting to add review"),DBHelper.postOflineReview(parseInt(e),t).then(e=>{document.getElementById("reviews-list").appendChild(createReviewHTML(e)),showMessage("Review now added")}))},5e3)}}),createReviewHTML=((e,t)=>{const a=document.createElement("li");a.className="review";const n=document.createElement("div");n.className="reviewHeader mainContainer",a.appendChild(n);const r=document.createElement("p");r.className="name reviewHeaderContent",r.innerHTML=e.name,n.appendChild(r);const i=t,s=document.createElement("p");s.className="date reviewHeaderContent",s.innerHTML=new Date(i).toDateString(),n.appendChild(s);const l=document.createElement("div"),o=document.createElement("strong");l.className="rating",l.innerHTML=`Rating: ${e.rating}`,o.appendChild(l),a.appendChild(o);const d=document.createElement("p");return d.innerHTML=e.comments,a.appendChild(d),a}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),a=document.createElement("li");a.innerHTML=e.name,t.appendChild(a)}),showMessage=(e=>{document.getElementById("modalMessage").innerHTML=e,document.getElementById("messageModal").style.display="block"}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const a=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}),strip=(e=>e.replace(/(<([^>]+)>)/gi,""));
//# sourceMappingURL=restaurant_info.js.map