{"version":3,"sources":["indexController.js"],"names":["_trackInstalling","worker","indexController","this","addEventListener","state","_updateReady","postMessage","action","navigator","window","serviceWorker","register","then","reg","refreshing","console","log","scope","controller","waiting","installing","location","reload","err"],"mappings":"AA8CA,SAASA,iBAAiBC,GAEzB,IAAIC,EAAkBC,KACtBF,EAAOG,iBAAiB,cAAe,WAClB,aAAhBH,EAAOI,OACVH,EAAgBI,aAAaL,KAKhC,SAASK,aAAaL,GAIrBA,EAAOM,aAAaC,OAAQ,gBA5DzB,kBAAmBC,WAErBC,OAAON,iBAAiB,OAAQ,WAE9BK,UAAUE,cAAcC,SAAS,UAAUC,KAAK,SAASC,GA2B3D,IAAIC,GAxBCC,QAAQC,IAAI,qDAAsDH,EAAII,OACtET,UAAUE,cAAcQ,cAKzBL,EAAIM,QAEPd,aAAaQ,EAAIM,SAIdN,EAAIO,WAEJrB,iBAAiBc,EAAIO,aAIvBP,EAAIV,iBAAiB,cAAe,WAEnCJ,iBAAiBc,EAAIO,cAKxBZ,UAAUE,cAAcP,iBAAiB,mBAAoB,WAExDW,IACJL,OAAOY,SAASC,SAChBR,GAAa,QAET,SAASS,GAGTR,QAAQC,IAAI,sCAAuCO","file":"indexController.js","sourcesContent":["if ('serviceWorker' in navigator) \r\n{\r\n  window.addEventListener('load', function() \r\n  {\r\n    navigator.serviceWorker.register('/sw.js').then(function(reg) \r\n    {\r\n      \t// Registration was successful\r\n      \tconsole.log('ServiceWorker registration successful with scope: ', reg.scope);\r\n\t\tif (!navigator.serviceWorker.controller) \r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (reg.waiting) \r\n\t\t{\r\n\t\t\t_updateReady(reg.waiting);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (reg.installing) \r\n\t\t{\r\n\t    \t_trackInstalling(reg.installing);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n  \t\treg.addEventListener('updatefound', function() \r\n  \t\t{\r\n\t  \t\t_trackInstalling(reg.installing);\r\n\t\t});\r\n\t\t// Ensure refresh is only called once.\r\n\t\t// This works around a bug in \"force update on reload\".\r\n\t\tvar refreshing;\r\n\t\tnavigator.serviceWorker.addEventListener('controllerchange', function() \r\n\t\t{\r\n\t\t\tif (refreshing) return;\r\n\t\t\twindow.location.reload();\r\n\t\t\trefreshing = true;\r\n\t\t});\r\n    }, function(err) \r\n    {\r\n      \t// registration failed :(\r\n      \tconsole.log('ServiceWorker registration failed: ', err);\r\n    });\r\n  });\r\n}\r\n\r\nfunction _trackInstalling(worker) \r\n{\r\n\tvar indexController = this;\r\n\tworker.addEventListener('statechange', function() {\r\n\t\tif (worker.state == 'installed') {\r\n\t\t\tindexController._updateReady(worker);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction _updateReady(worker) \r\n{\r\n\t//I need to add the update stuff in here\r\n\t//Then do this:\r\n\tworker.postMessage({action: 'skipWaiting'});\r\n}\r\n"]}